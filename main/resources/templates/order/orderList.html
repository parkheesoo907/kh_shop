<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header}"/>
<body>
<div class="container py-5">
  <div th:replace="~{fragments/bodyHeader :: bodyHeader}"/>

  <h2 class="mb-4 text-center">ğŸ“‹ ì£¼ë¬¸ ë‚´ì—­</h2>

  <!-- ê²€ìƒ‰ í¼ -->
  <form th:object="${orderSearch}" class="row g-2 mb-4">
    <div class="col-md-4">
      <input type="text" th:field="*{memberName}" class="form-control" placeholder="íšŒì›ëª…"/>
    </div>
    <div class="col-md-4">
      <select th:field="*{orderStatus}" class="form-select">
        <option value="">ì£¼ë¬¸ìƒíƒœ</option>
        <option th:each="status : ${T(jpabook.jpashop.domain.OrderStatus).values()}"
                th:value="${status}" th:text="${status}">option</option>
      </select>
    </div>
    <div class="col-md-4">
      <button type="submit" class="btn btn-primary w-100">ê²€ìƒ‰</button>
    </div>
  </form>

  <!-- ì£¼ë¬¸ í…Œì´ë¸” -->
  <table class="table table-striped table-hover text-center align-middle">
    <thead class="table-light">
    <tr>
      <th>#</th>
      <th>íšŒì›ëª…</th>
      <th>ìƒí’ˆì´ë¦„</th>
      <th>ì£¼ë¬¸ê°€ê²©</th>
      <th>ìˆ˜ëŸ‰</th>
      <th>ìƒíƒœ</th>
      <th>ì¼ì‹œ</th>
      <th>ì·¨ì†Œ</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="item : ${orders}">
      <td th:text="${item.id}">1</td>
      <td th:text="${item.member.name}">í™ê¸¸ë™</td>
      <td th:text="${item.orderItems[0].item.name}">ìƒí’ˆëª…</td>
      <td th:text="${item.orderItems[0].orderPrice}">10000</td>
      <td th:text="${item.orderItems[0].count}">2</td>
      <td th:text="${item.status}">ORDER</td>
      <td th:text="${#temporals.format(item.orderDate, 'yyyy-MM-dd HH:mm')}">2025-04-25</td>
      <td>
        <a th:if="${item.status.name() == 'ORDER'}"
           href="#"
           th:href="'javascript:cancel(' + ${item.id} + ')'"
           class="btn btn-sm btn-outline-danger">CANCEL</a>
        <span th:if="${item.status.name() != 'ORDER'}" class="text-muted">-</span>
      </td>
    </tr>
    </tbody>
  </table>

  <div class="text-center mt-4">
    <a href="/" class="text-decoration-none">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
  </div>

  <div th:replace="~{fragments/footer :: footer}"/>
</div>

<!-- ì£¼ë¬¸ ì·¨ì†Œ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
  function cancel(id) {
    const form = document.createElement("form");
    form.setAttribute("method", "post");
    form.setAttribute("action", "/orders/" + id + "/cancel");
    document.body.appendChild(form);
    form.submit();
  }
</script>
</body>
</html>
